# True content

## Task

We are creating a website but for now, there is no much content ready, can you check if there is anything interesting?

http://web1.affinityctf.com

## Solution

The link performs a redirect to an empty page. Let's look at the response body of the redirect:

```html
<html>
<head>
<title>Not here..</title>
<meta http-equiv="refresh" content="0; url=http://web1.affinityctf.com/construction.html" />
<script src="http://web1.affinityctf.com/redirect.js"> </script>
</head>
<body></body>
</html>
```

Let's look at `redirect.js`:

```javascript
var _0x43ef=['log','3_y'];(function(_0x59c077,_0x43efff){var _0x14ee75=function(_0x594891){while(--_0x594891){_0x59c077['push'](_0x59c077['shift']());}};_0x14ee75(++_0x43efff);}(_0x43ef,0x71));var _0x14ee=function(_0x59c077,_0x43efff){_0x59c077=_0x59c077-0x0;var _0x14ee75=_0x43ef[_0x59c077];return _0x14ee75;};var _0x5948=function(_0x59c077,_0x43efff){_0x59c077=_0x59c077-0x0;var _0x14ee75=_0x43ef[_0x59c077];if(_0x5948['nYXctf']===undefined){var _0x594891=function(_0x575770){var _0x5bf418='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=',_0x2562dd=String(_0x575770)['replace'](/=+$/,'');var _0x2b8d13='';for(var _0x163295=0x0,_0x505835,_0x100b31,_0x12266f=0x0;_0x100b31=_0x2562dd['charAt'](_0x12266f++);~_0x100b31&&(_0x505835=_0x163295%0x4?_0x505835*0x40+_0x100b31:_0x100b31,_0x163295++%0x4)?_0x2b8d13+=String['fromCharCode'](0xff&_0x505835>>(-0x2*_0x163295&0x6)):0x0){_0x100b31=_0x5bf418['indexOf'](_0x100b31);}return _0x2b8d13;};var _0x5b460f=function(_0x278d9c,_0x5b848e){var _0x40b45e=[],_0xbd9ddb=0x0,_0x3b736c,_0x24fe87='',_0x297a0e='';_0x278d9c=_0x594891(_0x278d9c);for(var _0x7aa4b4=0x0,_0xecfba1=_0x278d9c['length'];_0x7aa4b4<_0xecfba1;_0x7aa4b4++){_0x297a0e+='%'+('00'+_0x278d9c['charCodeAt'](_0x7aa4b4)['toString'](0x10))['slice'](-0x2);}_0x278d9c=decodeURIComponent(_0x297a0e);var _0x24d1cb;for(_0x24d1cb=0x0;_0x24d1cb<0x100;_0x24d1cb++){_0x40b45e[_0x24d1cb]=_0x24d1cb;}for(_0x24d1cb=0x0;_0x24d1cb<0x100;_0x24d1cb++){_0xbd9ddb=(_0xbd9ddb+_0x40b45e[_0x24d1cb]+_0x5b848e['charCodeAt'](_0x24d1cb%_0x5b848e['length']))%0x100,_0x3b736c=_0x40b45e[_0x24d1cb],_0x40b45e[_0x24d1cb]=_0x40b45e[_0xbd9ddb],_0x40b45e[_0xbd9ddb]=_0x3b736c;}_0x24d1cb=0x0,_0xbd9ddb=0x0;for(var _0x717542=0x0;_0x717542<_0x278d9c['length'];_0x717542++){_0x24d1cb=(_0x24d1cb+0x1)%0x100,_0xbd9ddb=(_0xbd9ddb+_0x40b45e[_0x24d1cb])%0x100,_0x3b736c=_0x40b45e[_0x24d1cb],_0x40b45e[_0x24d1cb]=_0x40b45e[_0xbd9ddb],_0x40b45e[_0xbd9ddb]=_0x3b736c,_0x24fe87+=String['fromCharCode'](_0x278d9c['charCodeAt'](_0x717542)^_0x40b45e[(_0x40b45e[_0x24d1cb]+_0x40b45e[_0xbd9ddb])%0x100]);}return _0x24fe87;};_0x5948['uytZNF']=_0x5b460f,_0x5948['ngVVfy']={},_0x5948['nYXctf']=!![];}var _0x19c019=_0x5948['ngVVfy'][_0x59c077];return _0x19c019===undefined?(_0x5948['qtLhBJ']===undefined&&(_0x5948['qtLhBJ']=!![]),_0x14ee75=_0x5948['uytZNF'](_0x14ee75,_0x43efff),_0x5948['ngVVfy'][_0x59c077]=_0x14ee75):_0x14ee75=_0x19c019,_0x14ee75;};var _0x214fe9=_0x14ee,s='AF',sn='FC',sm='TF{',sp='h3r',sd=_0x214fe9('0x0'),sl='0u',sk='_',sj='g0',st='}';function getData(_0x473f17=!![]){var _0x343a6a=_0x214fe9;if(_0x473f17){var _0x83d964=s+sn+sm+sp+sd+sl+sk+sj+st;console[_0x343a6a('0x1')](_0x83d964);}}getData(false);
```

Beautify it:

```javascript
var _0x43ef=['log','3_y'];
(function(_0x59c077, _0x43efff) {
    var _0x14ee75 = function(_0x594891) {
        while (--_0x594891) {
            _0x59c077['push'](_0x59c077['shift']());
        }
    };
    _0x14ee75(++_0x43efff);
}(_0x43ef, 0x71));
var _0x14ee = function(_0x59c077, _0x43efff) {
    _0x59c077 = _0x59c077 - 0x0;
    var _0x14ee75 = _0x43ef[_0x59c077];
    return _0x14ee75;
};
var _0x5948 = function(_0x59c077, _0x43efff) {
    _0x59c077 = _0x59c077 - 0x0;
    var _0x14ee75 = _0x43ef[_0x59c077];
    if (_0x5948['nYXctf'] === undefined) {
        var _0x594891 = function(_0x575770) {
            var _0x5bf418 = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=',
                _0x2562dd = String(_0x575770)['replace'](/=+$/, '');
            var _0x2b8d13 = '';
            for (var _0x163295 = 0x0, _0x505835, _0x100b31, _0x12266f = 0x0; _0x100b31 = _0x2562dd['charAt'](_0x12266f++); ~_0x100b31 && (_0x505835 = _0x163295 % 0x4 ? _0x505835 * 0x40 + _0x100b31 : _0x100b31, _0x163295++ % 0x4) ? _0x2b8d13 += String['fromCharCode'](0xff & _0x505835 >> (-0x2 * _0x163295 & 0x6)) : 0x0) {
                _0x100b31 = _0x5bf418['indexOf'](_0x100b31);
            }
            return _0x2b8d13;
        };
        var _0x5b460f = function(_0x278d9c, _0x5b848e) {
            var _0x40b45e = [],
                _0xbd9ddb = 0x0,
                _0x3b736c, _0x24fe87 = '',
                _0x297a0e = '';
            _0x278d9c = _0x594891(_0x278d9c);
            for (var _0x7aa4b4 = 0x0, _0xecfba1 = _0x278d9c['length']; _0x7aa4b4 < _0xecfba1; _0x7aa4b4++) {
                _0x297a0e += '%' + ('00' + _0x278d9c['charCodeAt'](_0x7aa4b4)['toString'](0x10))['slice'](-0x2);
            }
            _0x278d9c = decodeURIComponent(_0x297a0e);
            var _0x24d1cb;
            for (_0x24d1cb = 0x0; _0x24d1cb < 0x100; _0x24d1cb++) {
                _0x40b45e[_0x24d1cb] = _0x24d1cb;
            }
            for (_0x24d1cb = 0x0; _0x24d1cb < 0x100; _0x24d1cb++) {
                _0xbd9ddb = (_0xbd9ddb + _0x40b45e[_0x24d1cb] + _0x5b848e['charCodeAt'](_0x24d1cb % _0x5b848e['length'])) % 0x100, _0x3b736c = _0x40b45e[_0x24d1cb], _0x40b45e[_0x24d1cb] = _0x40b45e[_0xbd9ddb], _0x40b45e[_0xbd9ddb] = _0x3b736c;
            }
            _0x24d1cb = 0x0, _0xbd9ddb = 0x0;
            for (var _0x717542 = 0x0; _0x717542 < _0x278d9c['length']; _0x717542++) {
                _0x24d1cb = (_0x24d1cb + 0x1) % 0x100, _0xbd9ddb = (_0xbd9ddb + _0x40b45e[_0x24d1cb]) % 0x100, _0x3b736c = _0x40b45e[_0x24d1cb], _0x40b45e[_0x24d1cb] = _0x40b45e[_0xbd9ddb], _0x40b45e[_0xbd9ddb] = _0x3b736c, _0x24fe87 += String['fromCharCode'](_0x278d9c['charCodeAt'](_0x717542) ^ _0x40b45e[(_0x40b45e[_0x24d1cb] + _0x40b45e[_0xbd9ddb]) % 0x100]);
            }
            return _0x24fe87;
        };
        _0x5948['uytZNF'] = _0x5b460f, _0x5948['ngVVfy'] = {}, _0x5948['nYXctf'] = !![];
    }
    var _0x19c019 = _0x5948['ngVVfy'][_0x59c077];
    return _0x19c019 === undefined ? (_0x5948['qtLhBJ'] === undefined && (_0x5948['qtLhBJ'] = !![]), _0x14ee75 = _0x5948['uytZNF'](_0x14ee75, _0x43efff), _0x5948['ngVVfy'][_0x59c077] = _0x14ee75) : _0x14ee75 = _0x19c019, _0x14ee75;
};
var _0x214fe9 = _0x14ee,
    s = 'AF',
    sn = 'FC',
    sm = 'TF{',
    sp = 'h3r',
    sd = _0x214fe9('0x0'),
    sl = '0u',
    sk = '_',
    sj = 'g0',
    st = '}';

function getData(_0x473f17 = !![]) {
    var _0x343a6a = _0x214fe9;
    if (_0x473f17) {
        var _0x83d964 = s + sn + sm + sp + sd + sl + sk + sj + st;
        console[_0x343a6a('0x1')](_0x83d964);
    }
}
getData(false);
```

Our flag is in `_0x83d964`, concatenated parts of the variables declared after `_0x214fe9`.

One variable is resolved using `_0x14ee` which converts the hex string to a `number` and returns the element from `_0x43ef` at that position. The first function manipulates that array, it's called with it. It's just reversing the list. So `0x0` is actually the last element.

```
> var s='AF',sn='FC',sm='TF{',sp='h3r',sd='3_y',sl='0u',sk='_',sj='g0',st='}';
> s + sn + sm + sp + sd + sl + sk + sj + st;
"AFFCTF{h3r3_y0u_g0}"
```
